# eMedia Consulting simpleRedak - Reflected Cross-Site Scripting

A reflected Cross-Site Scripting (XSS) vulnerability was discovered in the /view/cb/format_642.php component. 

The vulnerability was reported as CVE-2023-33761.

__Versions affected: simpleRedak <= 2.47.23.05__
 
![Figure 1: Reflected XSS via injecting a malicious string into a URL parameter](33761_1.png "Figure 1: Reflected XSS via injecting a malicious string into a URL parameter")

Figure 1: Reflected XSS via injecting a malicious string into a URL parameter

## Background

An attacker may craft a malicious link that contains an XSS payload. Should the victim click on the link, this could lead to XSS in their browser window.

## Steps to Reproduce

For the proof-of-concept screenshots we have used the following payload:
```
<url>/module/castingbogen/view/cb/format_642.php/qyhgn%22%3E%3Cscript%3Ealert(document.location)%3C/script%3Eb0uud?code=dd3c28e36a&cast=2479882
```

## Root Cause

This issue exists due to insufficient input filtering in a form that reflects the full URL in the "action" attribute value. By supplying a double quote character (") it is possible to break out of the attribute string and inject custom HTML.

![Figure 2: Root cause: Insufficient input filtering in the reflected URL](33761_2.png "Figure 2: Root cause: Insufficient input filtering in the reflected URL")

Figure 2: Root cause: Insufficient input filtering in the reflected URL

## Fix

All software versions up to and including version 2.47.23.05 are affected. The vendor was informed of the finding on May 5, 2023. The vulnerability is fixed with version 2.47.23.06.
